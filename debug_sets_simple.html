<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📦 LEGO Sets Database - DEBUG</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f0f0f0;
        }
        .debug-info {
            background: #ffffcc;
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
        }
        .sets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .set-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            overflow: hidden;
            padding: 10px;
        }
        .set-title {
            font-weight: bold;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>📦 LEGO Sets Database - DEBUG</h1>
    
    <div id="debugInfo" class="debug-info">
        <h3>Debug Information:</h3>
        <div id="debugContent">Loading...</div>
    </div>
    
    <div id="setsGrid" class="sets-grid"></div>
    
    <script>
        console.log("🚀 Script starting...");
        
        // Usa gli stessi dati della pagina originale
        const setsData = [{"code": "10237", "name": "10237 Tower of Orthanc", "pieces": "2359", "minifigs": "5", "released": "July 2013", "theme": "The Lord of the Rings", "price_eur": null, "price_gbp": "£169.99", "image_path": "images/10237.jpg", "has_image": true}, {"code": "10316", "name": "10316 The Lord of the Rings Rivendell", "pieces": "6167", "minifigs": "21", "released": "March 5, 2023", "theme": "Icons", "price_eur": null, "price_gbp": "£429.99", "image_path": "images/10316.jpg", "has_image": true}];
        
        let filteredData = [...setsData];
        let currentPage = 1;
        const itemsPerPage = 12;
        
        function updateDebug(message) {
            console.log("🐛 " + message);
            const debugDiv = document.getElementById('debugContent');
            if (debugDiv) {
                debugDiv.innerHTML += "<p>" + message + "</p>";
            }
        }
        
        updateDebug("Data loaded: " + setsData.length + " sets");
        updateDebug("filteredData length: " + filteredData.length);
        
        function renderSets() {
            updateDebug("renderSets() called");
            
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageData = filteredData.slice(startIndex, endIndex);
            
            updateDebug("Page data: " + pageData.length + " items");
            
            const grid = document.getElementById('setsGrid');
            updateDebug("Grid element found: " + !!grid);
            
            if (!grid) {
                updateDebug("ERROR: Grid element not found!");
                return;
            }
            
            if (pageData.length === 0) {
                updateDebug("No data to show");
                grid.innerHTML = '<div style="text-align: center; padding: 40px;"><h3>No sets found</h3></div>';
            } else {
                updateDebug("Rendering " + pageData.length + " sets");
                
                const html = pageData.map(set => `
                    <div class="set-card">
                        <div class="set-title">${set.code}: ${set.name}</div>
                        <div>🧩 ${set.pieces} pieces</div>
                        <div>👥 ${set.minifigs} minifigs</div>
                        <div>📅 ${set.released}</div>
                        <div>🏷️ ${set.theme}</div>
                    </div>
                `).join('');
                
                grid.innerHTML = html;
                updateDebug("HTML set, length: " + html.length + " chars");
            }
        }
        
        updateDebug("Setting up DOMContentLoaded listener...");
        
        document.addEventListener('DOMContentLoaded', function() {
            updateDebug("DOMContentLoaded fired!");
            renderSets();
        });
        
        // Test anche immediato per sicurezza
        setTimeout(() => {
            updateDebug("Timeout render test...");
            renderSets();
        }, 100);
        
        updateDebug("Script initialization complete");
    </script>
</body>
</html>
