<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Sets Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug { background: #ffeb3b; padding: 10px; margin: 10px 0; }
        .error { background: #ffcdd2; padding: 10px; margin: 10px 0; }
        .success { background: #c8e6c9; padding: 10px; margin: 10px 0; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .test-card { background: white; border: 1px solid #ccc; padding: 10px; }
    </style>
</head>
<body>
    <h1>Debug Sets Page</h1>
    <div id="status" class="debug">Testing...</div>
    <div id="results"></div>
    
    <script>
        function updateStatus(message, type = 'debug') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = type;
            statusDiv.innerHTML = message;
        }
        
        function logResult(message) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += `<div class="debug">${message}</div>`;
        }
        
        // Test 1: Basic JavaScript
        updateStatus("Test 1: JavaScript execution");
        logResult("‚úÖ JavaScript is running");
        
        // Test 2: Data loading (copia i dati dalla pagina originale)
        const testData = [
            {"code": "10237", "name": "10237 Tower of Orthanc", "pieces": "2359", "minifigs": "5", "released": "July 2013", "theme": "The Lord of the Rings", "price_eur": null, "price_gbp": "¬£169.99", "image_path": "images/10237.jpg", "has_image": true},
            {"code": "10316", "name": "10316 The Lord of the Rings Rivendell", "pieces": "6167", "minifigs": "21", "released": "March 5, 2023", "theme": "Icons", "price_eur": null, "price_gbp": "¬£429.99", "image_path": "images/10316.jpg", "has_image": true}
        ];
        
        logResult(`‚úÖ Test data loaded: ${testData.length} items`);
        
        // Test 3: DOM elements
        updateStatus("Test 3: DOM manipulation");
        
        function testDOMElements() {
            const testGrid = document.createElement('div');
            testGrid.className = 'test-grid';
            testGrid.id = 'testGrid';
            
            document.body.appendChild(testGrid);
            
            logResult("‚úÖ Test grid element created");
            
            // Test 4: Rendering
            updateStatus("Test 4: Rendering test data");
            
            if (testData.length === 0) {
                testGrid.innerHTML = '<div class="error">No data found</div>';
                logResult("‚ùå No data to render");
            } else {
                const html = testData.map(set => `
                    <div class="test-card">
                        <h4>${set.code}: ${set.name}</h4>
                        <p>üß© ${set.pieces} pieces</p>
                        <p>üë• ${set.minifigs} minifigs</p>
                        <p>üìÖ ${set.released}</p>
                        <p>üè∑Ô∏è ${set.theme}</p>
                        <img src="${set.image_path}" alt="Test" style="width: 100px; height: 100px; object-fit: contain;" 
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2VlZSIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1zaXplPSIxMiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk5vIEltYWdlPC90ZXh0Pjwvc3ZnPg=='">
                    </div>
                `).join('');
                
                testGrid.innerHTML = html;
                logResult(`‚úÖ Rendered ${testData.length} test items`);
                logResult(`HTML length: ${html.length} characters`);
            }
            
            updateStatus("Test completed", "success");
        }
        
        // Test 5: Error handling
        window.onerror = function(message, source, lineno, colno, error) {
            updateStatus(`‚ùå JavaScript Error: ${message}`, "error");
            logResult(`Error at line ${lineno}: ${message}`);
        };
        
        // Run tests
        document.addEventListener('DOMContentLoaded', testDOMElements);
        
        // Fallback test
        setTimeout(testDOMElements, 100);
    </script>
</body>
</html>
